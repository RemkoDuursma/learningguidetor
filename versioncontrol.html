<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Version control with git | A Learning Guide to R: data, analytical, and programming skills.</title>
  <meta name="description" content="This book teaches introductory to intermediate skills in R." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Version control with git | A Learning Guide to R: data, analytical, and programming skills." />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book teaches introductory to intermediate skills in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Version control with git | A Learning Guide to R: data, analytical, and programming skills." />
  
  <meta name="twitter:description" content="This book teaches introductory to intermediate skills in R." />
  

<meta name="author" content="Remko Duursma" />


<meta name="date" content="2020-11-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="webservices.html"/>
<link rel="next" href="masteringpackages.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Learning Guide to R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#aboutauthor"><i class="fa fa-check"></i>About the author</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Beginner skills</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#installingr"><i class="fa fa-check"></i><b>1.1</b> Installing R and Rstudio</a><ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#exampledata"><i class="fa fa-check"></i><b>1.1.1</b> Example data used throughout this book</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#basicops"><i class="fa fa-check"></i><b>1.2</b> Basic operations</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#vectorintro"><i class="fa fa-check"></i><b>1.3</b> Working with vectors</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#writing-code-in-a-script"><i class="fa fa-check"></i><b>1.4</b> Writing code in a script</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#vectorized"><i class="fa fa-check"></i><b>1.5</b> Vectorized operations</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#multifunctions"><i class="fa fa-check"></i><b>1.5.1</b> Applying multiple functions at once</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#matrices"><i class="fa fa-check"></i><b>1.6</b> Working with matrices</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#objects-in-the-workspace"><i class="fa fa-check"></i><b>1.7</b> Objects in the workspace</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#fileswd"><i class="fa fa-check"></i><b>1.8</b> Files in the working directory</a></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#rstudio-projects"><i class="fa fa-check"></i><b>1.9</b> Rstudio projects</a></li>
<li class="chapter" data-level="1.10" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>1.10</b> Packages</a><ul>
<li class="chapter" data-level="1.10.1" data-path="intro.html"><a href="intro.html#installpackage"><i class="fa fa-check"></i><b>1.10.1</b> Install packages from CRAN</a></li>
<li class="chapter" data-level="1.10.2" data-path="intro.html"><a href="intro.html#loadpackage"><i class="fa fa-check"></i><b>1.10.2</b> Loading packages</a></li>
<li class="chapter" data-level="1.10.3" data-path="intro.html"><a href="intro.html#setting-the-cran-mirror"><i class="fa fa-check"></i><b>1.10.3</b> Setting the CRAN mirror</a></li>
<li class="chapter" data-level="1.10.4" data-path="intro.html"><a href="intro.html#install-from-git-hosting-sites"><i class="fa fa-check"></i><b>1.10.4</b> Install from git hosting sites</a></li>
<li class="chapter" data-level="1.10.5" data-path="intro.html"><a href="intro.html#updating-r-and-package-locations"><i class="fa fa-check"></i><b>1.10.5</b> Updating R and package locations</a></li>
<li class="chapter" data-level="1.10.6" data-path="intro.html"><a href="intro.html#updatingpackages"><i class="fa fa-check"></i><b>1.10.6</b> Updating packages</a></li>
<li class="chapter" data-level="1.10.7" data-path="intro.html"><a href="intro.html#install-missing-packages"><i class="fa fa-check"></i><b>1.10.7</b> Install missing packages</a></li>
<li class="chapter" data-level="1.10.8" data-path="intro.html"><a href="intro.html#conflicts"><i class="fa fa-check"></i><b>1.10.8</b> Conflicts</a></li>
<li class="chapter" data-level="1.10.9" data-path="intro.html"><a href="intro.html#pacman"><i class="fa fa-check"></i><b>1.10.9</b> Loading many packages</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="intro.html"><a href="intro.html#helpfiles"><i class="fa fa-check"></i><b>1.11</b> Accessing the help files</a></li>
<li class="chapter" data-level="1.12" data-path="intro.html"><a href="intro.html#writing-lots-of-code-rmarkdown-or-scripts"><i class="fa fa-check"></i><b>1.12</b> Writing lots of code: rmarkdown or scripts?</a><ul>
<li class="chapter" data-level="1.12.1" data-path="intro.html"><a href="intro.html#reproducible-documents-with-rmarkdown"><i class="fa fa-check"></i><b>1.12.1</b> Reproducible documents with rmarkdown</a></li>
<li class="chapter" data-level="1.12.2" data-path="intro.html"><a href="intro.html#scripts"><i class="fa fa-check"></i><b>1.12.2</b> Using R scripts</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="intro.html"><a href="intro.html#pay-attention-to-detail-write-clean-code"><i class="fa fa-check"></i><b>1.13</b> Pay attention to detail: write clean code</a></li>
<li class="chapter" data-level="1.14" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.14</b> Exercises</a><ul>
<li class="chapter" data-level="1.14.1" data-path="intro.html"><a href="intro.html#calculating"><i class="fa fa-check"></i><b>1.14.1</b> Calculating</a></li>
<li class="chapter" data-level="1.14.2" data-path="intro.html"><a href="intro.html#simple-objects"><i class="fa fa-check"></i><b>1.14.2</b> Simple objects</a></li>
<li class="chapter" data-level="1.14.3" data-path="intro.html"><a href="intro.html#vecexerc1"><i class="fa fa-check"></i><b>1.14.3</b> Working with a single vector</a></li>
<li class="chapter" data-level="1.14.4" data-path="intro.html"><a href="intro.html#scriptexercise"><i class="fa fa-check"></i><b>1.14.4</b> Scripts</a></li>
<li class="chapter" data-level="1.14.5" data-path="intro.html"><a href="intro.html#exquote"><i class="fa fa-check"></i><b>1.14.5</b> To quote or not to quote</a></li>
<li class="chapter" data-level="1.14.6" data-path="intro.html"><a href="intro.html#working-with-two-vectors"><i class="fa fa-check"></i><b>1.14.6</b> Working with two vectors</a></li>
<li class="chapter" data-level="1.14.7" data-path="intro.html"><a href="intro.html#alphabet-aerobics-1"><i class="fa fa-check"></i><b>1.14.7</b> Alphabet aerobics 1</a></li>
<li class="chapter" data-level="1.14.8" data-path="intro.html"><a href="intro.html#comparing-and-combining-vectors"><i class="fa fa-check"></i><b>1.14.8</b> Comparing and combining vectors</a></li>
<li class="chapter" data-level="1.14.9" data-path="intro.html"><a href="intro.html#into-the-matrix"><i class="fa fa-check"></i><b>1.14.9</b> Into the matrix</a></li>
<li class="chapter" data-level="1.14.10" data-path="intro.html"><a href="intro.html#packages-1"><i class="fa fa-check"></i><b>1.14.10</b> Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="dataskills1.html"><a href="dataskills1.html"><i class="fa fa-check"></i><b>2</b> Data skills - Part 1</a><ul>
<li class="chapter" data-level="2.1" data-path="dataskills1.html"><a href="dataskills1.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="dataskills1.html"><a href="dataskills1.html#generating-data"><i class="fa fa-check"></i><b>2.2</b> Generating data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="dataskills1.html"><a href="dataskills1.html#sequences"><i class="fa fa-check"></i><b>2.2.1</b> Sequences of numbers</a></li>
<li class="chapter" data-level="2.2.2" data-path="dataskills1.html"><a href="dataskills1.html#randomnumbers"><i class="fa fa-check"></i><b>2.2.2</b> Random numbers</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="dataskills1.html"><a href="dataskills1.html#readingdata"><i class="fa fa-check"></i><b>2.3</b> Reading data</a><ul>
<li class="chapter" data-level="2.3.1" data-path="dataskills1.html"><a href="dataskills1.html#readcsv"><i class="fa fa-check"></i><b>2.3.1</b> Reading CSV files</a></li>
<li class="chapter" data-level="2.3.2" data-path="dataskills1.html"><a href="dataskills1.html#reading-large-csv-files"><i class="fa fa-check"></i><b>2.3.2</b> Reading large CSV files</a></li>
<li class="chapter" data-level="2.3.3" data-path="dataskills1.html"><a href="dataskills1.html#tabdelimtext"><i class="fa fa-check"></i><b>2.3.3</b> Reading Tab-delimited text files</a></li>
<li class="chapter" data-level="2.3.4" data-path="dataskills1.html"><a href="dataskills1.html#datainscript"><i class="fa fa-check"></i><b>2.3.4</b> Including data in a script</a></li>
<li class="chapter" data-level="2.3.5" data-path="dataskills1.html"><a href="dataskills1.html#json"><i class="fa fa-check"></i><b>2.3.5</b> JSON</a></li>
<li class="chapter" data-level="2.3.6" data-path="dataskills1.html"><a href="dataskills1.html#nosql-databases"><i class="fa fa-check"></i><b>2.3.6</b> (No)SQL databases</a></li>
<li class="chapter" data-level="2.3.7" data-path="dataskills1.html"><a href="dataskills1.html#excel-spreadsheets"><i class="fa fa-check"></i><b>2.3.7</b> Excel spreadsheets</a></li>
<li class="chapter" data-level="2.3.8" data-path="dataskills1.html"><a href="dataskills1.html#proprietary-formats"><i class="fa fa-check"></i><b>2.3.8</b> Proprietary formats</a></li>
<li class="chapter" data-level="2.3.9" data-path="dataskills1.html"><a href="dataskills1.html#web-services"><i class="fa fa-check"></i><b>2.3.9</b> Web services</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="dataskills1.html"><a href="dataskills1.html#dataframes"><i class="fa fa-check"></i><b>2.4</b> Working with dataframes</a><ul>
<li class="chapter" data-level="2.4.1" data-path="dataskills1.html"><a href="dataskills1.html#vecstodfr"><i class="fa fa-check"></i><b>2.4.1</b> Convert vectors into a dataframe</a></li>
<li class="chapter" data-level="2.4.2" data-path="dataskills1.html"><a href="dataskills1.html#vecdataframes"><i class="fa fa-check"></i><b>2.4.2</b> Variables in the dataframe</a></li>
<li class="chapter" data-level="2.4.3" data-path="dataskills1.html"><a href="dataskills1.html#namesdataframe"><i class="fa fa-check"></i><b>2.4.3</b> Changing column names in dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="dataskills1.html"><a href="dataskills1.html#extracting-data"><i class="fa fa-check"></i><b>2.5</b> Extracting data</a><ul>
<li class="chapter" data-level="2.5.1" data-path="dataskills1.html"><a href="dataskills1.html#vectorindexing"><i class="fa fa-check"></i><b>2.5.1</b> Vectors</a></li>
<li class="chapter" data-level="2.5.2" data-path="dataskills1.html"><a href="dataskills1.html#subsetdataframes"><i class="fa fa-check"></i><b>2.5.2</b> Dataframes</a></li>
<li class="chapter" data-level="2.5.3" data-path="dataskills1.html"><a href="dataskills1.html#a-faster-method"><i class="fa fa-check"></i><b>2.5.3</b> A faster method</a></li>
<li class="chapter" data-level="2.5.4" data-path="dataskills1.html"><a href="dataskills1.html#deleting-columns"><i class="fa fa-check"></i><b>2.5.4</b> Deleting columns</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="dataskills1.html"><a href="dataskills1.html#exportingdata"><i class="fa fa-check"></i><b>2.6</b> Exporting data</a></li>
<li class="chapter" data-level="2.7" data-path="dataskills1.html"><a href="dataskills1.html#special-data-types"><i class="fa fa-check"></i><b>2.7</b> Special data types</a><ul>
<li class="chapter" data-level="2.7.1" data-path="dataskills1.html"><a href="dataskills1.html#workingfactors"><i class="fa fa-check"></i><b>2.7.1</b> Working with factors</a></li>
<li class="chapter" data-level="2.7.2" data-path="dataskills1.html"><a href="dataskills1.html#workinglogic"><i class="fa fa-check"></i><b>2.7.2</b> Working with logical data</a></li>
<li class="chapter" data-level="2.7.3" data-path="dataskills1.html"><a href="dataskills1.html#workingmissing"><i class="fa fa-check"></i><b>2.7.3</b> Working with missing values</a></li>
<li class="chapter" data-level="2.7.4" data-path="dataskills1.html"><a href="dataskills1.html#workingtext"><i class="fa fa-check"></i><b>2.7.4</b> Working with text</a></li>
<li class="chapter" data-level="2.7.5" data-path="dataskills1.html"><a href="dataskills1.html#workingwithdates"><i class="fa fa-check"></i><b>2.7.5</b> Working with dates and times</a></li>
<li class="chapter" data-level="2.7.6" data-path="dataskills1.html"><a href="dataskills1.html#converttype"><i class="fa fa-check"></i><b>2.7.6</b> Converting between data types</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="dataskills1.html"><a href="dataskills1.html#exercises-1"><i class="fa fa-check"></i><b>2.8</b> Exercises</a><ul>
<li class="chapter" data-level="2.8.1" data-path="dataskills1.html"><a href="dataskills1.html#working-with-a-single-vector---indexing"><i class="fa fa-check"></i><b>2.8.1</b> Working with a single vector - indexing</a></li>
<li class="chapter" data-level="2.8.2" data-path="dataskills1.html"><a href="dataskills1.html#alphabet-aerobics-2"><i class="fa fa-check"></i><b>2.8.2</b> Alphabet aerobics 2</a></li>
<li class="chapter" data-level="2.8.3" data-path="dataskills1.html"><a href="dataskills1.html#basic-operations-with-the-cereals-data"><i class="fa fa-check"></i><b>2.8.3</b> Basic operations with the Cereals data</a></li>
<li class="chapter" data-level="2.8.4" data-path="dataskills1.html"><a href="dataskills1.html#a-short-dataset"><i class="fa fa-check"></i><b>2.8.4</b> A short dataset</a></li>
<li class="chapter" data-level="2.8.5" data-path="dataskills1.html"><a href="dataskills1.html#titanic---part-1"><i class="fa fa-check"></i><b>2.8.5</b> Titanic - Part 1</a></li>
<li class="chapter" data-level="2.8.6" data-path="dataskills1.html"><a href="dataskills1.html#titanic---part-2"><i class="fa fa-check"></i><b>2.8.6</b> Titanic - Part 2</a></li>
<li class="chapter" data-level="2.8.7" data-path="dataskills1.html"><a href="dataskills1.html#hydro-dam"><i class="fa fa-check"></i><b>2.8.7</b> Hydro dam</a></li>
<li class="chapter" data-level="2.8.8" data-path="dataskills1.html"><a href="dataskills1.html#hfe-tree-measurements"><i class="fa fa-check"></i><b>2.8.8</b> HFE tree measurements</a></li>
<li class="chapter" data-level="2.8.9" data-path="dataskills1.html"><a href="dataskills1.html#flux-data"><i class="fa fa-check"></i><b>2.8.9</b> Flux data</a></li>
<li class="chapter" data-level="2.8.10" data-path="dataskills1.html"><a href="dataskills1.html#dna-aerobics"><i class="fa fa-check"></i><b>2.8.10</b> DNA Aerobics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataskills2.html"><a href="dataskills2.html"><i class="fa fa-check"></i><b>3</b> Data skills - Part 2</a><ul>
<li class="chapter" data-level="3.1" data-path="dataskills2.html"><a href="dataskills2.html#summarizing-dataframes"><i class="fa fa-check"></i><b>3.1</b> Summarizing dataframes</a><ul>
<li class="chapter" data-level="3.1.1" data-path="dataskills2.html"><a href="dataskills2.html#tapplyaggregate"><i class="fa fa-check"></i><b>3.1.1</b> Making summary tables</a></li>
<li class="chapter" data-level="3.1.2" data-path="dataskills2.html"><a href="dataskills2.html#xtabs"><i class="fa fa-check"></i><b>3.1.2</b> Tables of counts</a></li>
<li class="chapter" data-level="3.1.3" data-path="dataskills2.html"><a href="dataskills2.html#summaryvars"><i class="fa fa-check"></i><b>3.1.3</b> Adding summary variables to dataframes</a></li>
<li class="chapter" data-level="3.1.4" data-path="dataskills2.html"><a href="dataskills2.html#reorder"><i class="fa fa-check"></i><b>3.1.4</b> Reordering factor levels based on a summary variable</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dataskills2.html"><a href="dataskills2.html#combining-dataframes"><i class="fa fa-check"></i><b>3.2</b> Combining dataframes</a><ul>
<li class="chapter" data-level="3.2.1" data-path="dataskills2.html"><a href="dataskills2.html#merge"><i class="fa fa-check"></i><b>3.2.1</b> Merging dataframes</a></li>
<li class="chapter" data-level="3.2.2" data-path="dataskills2.html"><a href="dataskills2.html#dplyrjoin"><i class="fa fa-check"></i><b>3.2.2</b> Using join from <code>dplyr</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="dataskills2.html"><a href="dataskills2.html#rbind"><i class="fa fa-check"></i><b>3.2.3</b> Row-binding dataframes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dataskills2.html"><a href="dataskills2.html#reshaping"><i class="fa fa-check"></i><b>3.3</b> Reshaping data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="dataskills2.html"><a href="dataskills2.html#from-wide-to-long"><i class="fa fa-check"></i><b>3.3.1</b> From wide to long</a></li>
<li class="chapter" data-level="3.3.2" data-path="dataskills2.html"><a href="dataskills2.html#from-long-to-wide"><i class="fa fa-check"></i><b>3.3.2</b> From long to wide</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataskills2.html"><a href="dataskills2.html#more-complex-dplyr-examples"><i class="fa fa-check"></i><b>3.4</b> More complex <code>dplyr</code> examples</a><ul>
<li class="chapter" data-level="3.4.1" data-path="dataskills2.html"><a href="dataskills2.html#tree-growth-data-filter-and-multiple-groupings"><i class="fa fa-check"></i><b>3.4.1</b> Tree growth data: filter and multiple groupings</a></li>
<li class="chapter" data-level="3.4.2" data-path="dataskills2.html"><a href="dataskills2.html#crude-oil-production-find-top-exporters"><i class="fa fa-check"></i><b>3.4.2</b> Crude oil production: find top exporters</a></li>
<li class="chapter" data-level="3.4.3" data-path="dataskills2.html"><a href="dataskills2.html#weightlossdplyr"><i class="fa fa-check"></i><b>3.4.3</b> Weight loss data: make an irregular timeseries regular</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="dataskills2.html"><a href="dataskills2.html#exercises-2"><i class="fa fa-check"></i><b>3.5</b> Exercises</a><ul>
<li class="chapter" data-level="3.5.1" data-path="dataskills2.html"><a href="dataskills2.html#summarizing-the-cereal-data"><i class="fa fa-check"></i><b>3.5.1</b> Summarizing the cereal data</a></li>
<li class="chapter" data-level="3.5.2" data-path="dataskills2.html"><a href="dataskills2.html#words-and-the-weather"><i class="fa fa-check"></i><b>3.5.2</b> Words and the weather</a></li>
<li class="chapter" data-level="3.5.3" data-path="dataskills2.html"><a href="dataskills2.html#merging-data"><i class="fa fa-check"></i><b>3.5.3</b> Merging data</a></li>
<li class="chapter" data-level="3.5.4" data-path="dataskills2.html"><a href="dataskills2.html#merging-multiple-datasets"><i class="fa fa-check"></i><b>3.5.4</b> Merging multiple datasets</a></li>
<li class="chapter" data-level="3.5.5" data-path="dataskills2.html"><a href="dataskills2.html#ordered-boxplot"><i class="fa fa-check"></i><b>3.5.5</b> Ordered boxplot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="programming.html"><a href="programming.html"><i class="fa fa-check"></i><b>4</b> Functions, lists and loops</a><ul>
<li class="chapter" data-level="4.1" data-path="programming.html"><a href="programming.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="programming.html"><a href="programming.html#writefunctions"><i class="fa fa-check"></i><b>4.2</b> Writing functions</a><ul>
<li class="chapter" data-level="4.2.1" data-path="programming.html"><a href="programming.html#returning-results"><i class="fa fa-check"></i><b>4.2.1</b> Returning results</a></li>
<li class="chapter" data-level="4.2.2" data-path="programming.html"><a href="programming.html#functions-without-arguments"><i class="fa fa-check"></i><b>4.2.2</b> Functions without arguments</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="programming.html"><a href="programming.html#workinglists"><i class="fa fa-check"></i><b>4.3</b> Working with lists</a><ul>
<li class="chapter" data-level="4.3.1" data-path="programming.html"><a href="programming.html#indexing-lists"><i class="fa fa-check"></i><b>4.3.1</b> Indexing lists</a></li>
<li class="chapter" data-level="4.3.2" data-path="programming.html"><a href="programming.html#converting-lists-to-dataframes-or-vectors"><i class="fa fa-check"></i><b>4.3.2</b> Converting lists to dataframes or vectors</a></li>
<li class="chapter" data-level="4.3.3" data-path="programming.html"><a href="programming.html#combining-lists"><i class="fa fa-check"></i><b>4.3.3</b> Combining lists</a></li>
<li class="chapter" data-level="4.3.4" data-path="programming.html"><a href="programming.html#extracting-output-from-built-in-functions"><i class="fa fa-check"></i><b>4.3.4</b> Extracting output from built-in functions</a></li>
<li class="chapter" data-level="4.3.5" data-path="programming.html"><a href="programming.html#dfrlists"><i class="fa fa-check"></i><b>4.3.5</b> Creating lists from dataframes</a></li>
<li class="chapter" data-level="4.3.6" data-path="programming.html"><a href="programming.html#lapply"><i class="fa fa-check"></i><b>4.3.6</b> Applying functions to lists</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="programming.html"><a href="programming.html#simpleloops"><i class="fa fa-check"></i><b>4.4</b> Loops</a><ul>
<li class="chapter" data-level="4.4.1" data-path="programming.html"><a href="programming.html#better-indexing"><i class="fa fa-check"></i><b>4.4.1</b> Better indexing</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="programming.html"><a href="programming.html#functionsadvanced"><i class="fa fa-check"></i><b>4.5</b> Functions : advanced concepts</a><ul>
<li class="chapter" data-level="4.5.1" data-path="programming.html"><a href="programming.html#why-should-i-write-more-functions"><i class="fa fa-check"></i><b>4.5.1</b> Why should I write more functions?</a></li>
<li class="chapter" data-level="4.5.2" data-path="programming.html"><a href="programming.html#wrapfunctions"><i class="fa fa-check"></i><b>4.5.2</b> Wrapper functions</a></li>
<li class="chapter" data-level="4.5.3" data-path="programming.html"><a href="programming.html#wrapper-functions-to-ggplot2-or-dplyr"><i class="fa fa-check"></i><b>4.5.3</b> Wrapper functions to <code>ggplot2</code> or <code>dplyr</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="programming.html"><a href="programming.html#functions-that-take-vectors-as-input"><i class="fa fa-check"></i><b>4.5.4</b> Functions that take vectors as input</a></li>
<li class="chapter" data-level="4.5.5" data-path="programming.html"><a href="programming.html#if-then-else-switch"><i class="fa fa-check"></i><b>4.5.5</b> If, then, else … switch</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="programming.html"><a href="programming.html#defensive"><i class="fa fa-check"></i><b>4.6</b> Robust functions: defensive programming</a><ul>
<li class="chapter" data-level="4.6.1" data-path="programming.html"><a href="programming.html#argument-matching"><i class="fa fa-check"></i><b>4.6.1</b> Argument matching</a></li>
<li class="chapter" data-level="4.6.2" data-path="programming.html"><a href="programming.html#argument-checking"><i class="fa fa-check"></i><b>4.6.2</b> Argument checking</a></li>
<li class="chapter" data-level="4.6.3" data-path="programming.html"><a href="programming.html#sending-warnings-errors-messages"><i class="fa fa-check"></i><b>4.6.3</b> Sending warnings, errors, messages</a></li>
<li class="chapter" data-level="4.6.4" data-path="programming.html"><a href="programming.html#onexit"><i class="fa fa-check"></i><b>4.6.4</b> Executing code when the function ends (or fails)</a></li>
<li class="chapter" data-level="4.6.5" data-path="programming.html"><a href="programming.html#try"><i class="fa fa-check"></i><b>4.6.5</b> Catch errors with <code>try</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="programming.html"><a href="programming.html#dbiwrappers"><i class="fa fa-check"></i><b>4.6.6</b> Writing database wrapper functions</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="programming.html"><a href="programming.html#exercises-3"><i class="fa fa-check"></i><b>4.7</b> Exercises</a><ul>
<li class="chapter" data-level="4.7.1" data-path="programming.html"><a href="programming.html#writing-functions"><i class="fa fa-check"></i><b>4.7.1</b> Writing functions</a></li>
<li class="chapter" data-level="4.7.2" data-path="programming.html"><a href="programming.html#working-with-lists"><i class="fa fa-check"></i><b>4.7.2</b> Working with lists</a></li>
<li class="chapter" data-level="4.7.3" data-path="programming.html"><a href="programming.html#functions-for-histograms"><i class="fa fa-check"></i><b>4.7.3</b> Functions for histograms</a></li>
<li class="chapter" data-level="4.7.4" data-path="programming.html"><a href="programming.html#using-functions-to-make-many-plots"><i class="fa fa-check"></i><b>4.7.4</b> Using functions to make many plots</a></li>
<li class="chapter" data-level="4.7.5" data-path="programming.html"><a href="programming.html#monthly-weather-plots"><i class="fa fa-check"></i><b>4.7.5</b> Monthly weather plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="webservices.html"><a href="webservices.html"><i class="fa fa-check"></i><b>5</b> R on the web</a><ul>
<li class="chapter" data-level="5.1" data-path="webservices.html"><a href="webservices.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="webservices.html"><a href="webservices.html#reading-data-from-remote-databases"><i class="fa fa-check"></i><b>5.2</b> Reading data from remote databases</a><ul>
<li class="chapter" data-level="5.2.1" data-path="webservices.html"><a href="webservices.html#dbi"><i class="fa fa-check"></i><b>5.2.1</b> Accessing databases with the DBI package</a></li>
<li class="chapter" data-level="5.2.2" data-path="webservices.html"><a href="webservices.html#nosql"><i class="fa fa-check"></i><b>5.2.2</b> NoSQL</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="webservices.html"><a href="webservices.html#accessing-an-api"><i class="fa fa-check"></i><b>5.3</b> Accessing an API</a></li>
<li class="chapter" data-level="5.4" data-path="webservices.html"><a href="webservices.html#deploying-an-api-with-plumber"><i class="fa fa-check"></i><b>5.4</b> Deploying an API with <code>plumber</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="versioncontrol.html"><a href="versioncontrol.html"><i class="fa fa-check"></i><b>6</b> Version control with git</a><ul>
<li class="chapter" data-level="6.1" data-path="versioncontrol.html"><a href="versioncontrol.html#shouldigit"><i class="fa fa-check"></i><b>6.1</b> Should I learn version control?</a></li>
<li class="chapter" data-level="6.2" data-path="versioncontrol.html"><a href="versioncontrol.html#basics-of-git"><i class="fa fa-check"></i><b>6.2</b> Basics of git</a><ul>
<li class="chapter" data-level="6.2.1" data-path="versioncontrol.html"><a href="versioncontrol.html#basic-principles"><i class="fa fa-check"></i><b>6.2.1</b> Basic principles</a></li>
<li class="chapter" data-level="6.2.2" data-path="versioncontrol.html"><a href="versioncontrol.html#installing-git"><i class="fa fa-check"></i><b>6.2.2</b> Installing git</a></li>
<li class="chapter" data-level="6.2.3" data-path="versioncontrol.html"><a href="versioncontrol.html#using-git-in-rstudio"><i class="fa fa-check"></i><b>6.2.3</b> Using git in Rstudio</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="versioncontrol.html"><a href="versioncontrol.html#localgit"><i class="fa fa-check"></i><b>6.3</b> Local git repositories</a><ul>
<li class="chapter" data-level="6.3.1" data-path="versioncontrol.html"><a href="versioncontrol.html#firstgitsession"><i class="fa fa-check"></i><b>6.3.1</b> A first session with version control in Rstudio</a></li>
<li class="chapter" data-level="6.3.2" data-path="versioncontrol.html"><a href="versioncontrol.html#deleting-files-and-sensitive-information"><i class="fa fa-check"></i><b>6.3.2</b> Deleting files and sensitive information</a></li>
<li class="chapter" data-level="6.3.3" data-path="versioncontrol.html"><a href="versioncontrol.html#reverting-changes"><i class="fa fa-check"></i><b>6.3.3</b> Reverting changes</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="versioncontrol.html"><a href="versioncontrol.html#remotegit"><i class="fa fa-check"></i><b>6.4</b> Remote git repositories</a><ul>
<li class="chapter" data-level="6.4.1" data-path="versioncontrol.html"><a href="versioncontrol.html#makeremotegit"><i class="fa fa-check"></i><b>6.4.1</b> Making a remote repository</a></li>
<li class="chapter" data-level="6.4.2" data-path="versioncontrol.html"><a href="versioncontrol.html#gitremoteworkflow"><i class="fa fa-check"></i><b>6.4.2</b> Workflow</a></li>
<li class="chapter" data-level="6.4.3" data-path="versioncontrol.html"><a href="versioncontrol.html#a-session-with-a-remote-repository"><i class="fa fa-check"></i><b>6.4.3</b> A session with a remote repository</a></li>
<li class="chapter" data-level="6.4.4" data-path="versioncontrol.html"><a href="versioncontrol.html#conflicts-when-collaborating"><i class="fa fa-check"></i><b>6.4.4</b> Conflicts when collaborating</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="versioncontrol.html"><a href="versioncontrol.html#gitignore"><i class="fa fa-check"></i><b>6.5</b> Ignoring files</a></li>
<li class="chapter" data-level="6.6" data-path="versioncontrol.html"><a href="versioncontrol.html#commandline"><i class="fa fa-check"></i><b>6.6</b> Using the command line</a><ul>
<li class="chapter" data-level="6.6.1" data-path="versioncontrol.html"><a href="versioncontrol.html#basic-commands"><i class="fa fa-check"></i><b>6.6.1</b> Basic commands</a></li>
<li class="chapter" data-level="6.6.2" data-path="versioncontrol.html"><a href="versioncontrol.html#useful-tasks"><i class="fa fa-check"></i><b>6.6.2</b> Useful tasks</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="versioncontrol.html"><a href="versioncontrol.html#branches"><i class="fa fa-check"></i><b>6.7</b> Branches</a><ul>
<li class="chapter" data-level="6.7.1" data-path="versioncontrol.html"><a href="versioncontrol.html#facesoil_figures.r"><i class="fa fa-check"></i><b>6.7.1</b> <code>facesoil_figures.R</code></a></li>
<li class="chapter" data-level="6.7.2" data-path="versioncontrol.html"><a href="versioncontrol.html#facesoil_load"><i class="fa fa-check"></i><b>6.7.2</b> <code>facesoil_load</code></a></li>
<li class="chapter" data-level="6.7.3" data-path="versioncontrol.html"><a href="versioncontrol.html#load_packages.r"><i class="fa fa-check"></i><b>6.7.3</b> <code>load_packages.R</code></a></li>
<li class="chapter" data-level="6.7.4" data-path="versioncontrol.html"><a href="versioncontrol.html#facesoil_readdata.r"><i class="fa fa-check"></i><b>6.7.4</b> <code>facesoil_readdata.R</code></a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="versioncontrol.html"><a href="versioncontrol.html#archiving-the-output"><i class="fa fa-check"></i><b>6.8</b> Archiving the output</a><ul>
<li class="chapter" data-level="6.8.1" data-path="versioncontrol.html"><a href="versioncontrol.html#adding-a-date-stamp-to-output-files"><i class="fa fa-check"></i><b>6.8.1</b> Adding a Date stamp to output files</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="versioncontrol.html"><a href="versioncontrol.html#scriptstructure"><i class="fa fa-check"></i><b>6.9</b> A logical structure for your scripts</a><ul>
<li class="chapter" data-level="6.9.1" data-path="versioncontrol.html"><a href="versioncontrol.html#write-functions-not-long-scripts"><i class="fa fa-check"></i><b>6.9.1</b> Write functions, not long scripts</a></li>
<li class="chapter" data-level="6.9.2" data-path="versioncontrol.html"><a href="versioncontrol.html#divide-your-script-into-functional-blocks"><i class="fa fa-check"></i><b>6.9.2</b> Divide your script into functional blocks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="masteringpackages.html"><a href="masteringpackages.html"><i class="fa fa-check"></i><b>7</b> Mastering package dependencies</a><ul>
<li class="chapter" data-level="7.1" data-path="masteringpackages.html"><a href="masteringpackages.html#what-version"><i class="fa fa-check"></i><b>7.1</b> What version?</a></li>
<li class="chapter" data-level="7.2" data-path="masteringpackages.html"><a href="masteringpackages.html#all-packages-loaded-or-installed"><i class="fa fa-check"></i><b>7.2</b> All packages: loaded or installed</a></li>
<li class="chapter" data-level="7.3" data-path="masteringpackages.html"><a href="masteringpackages.html#avoidconflicts"><i class="fa fa-check"></i><b>7.3</b> Avoiding conflicts</a></li>
<li class="chapter" data-level="7.4" data-path="masteringpackages.html"><a href="masteringpackages.html#searchpath"><i class="fa fa-check"></i><b>7.4</b> The search path and conflicts</a></li>
<li class="chapter" data-level="7.5" data-path="masteringpackages.html"><a href="masteringpackages.html#bundling-package-dependencies-with-renv"><i class="fa fa-check"></i><b>7.5</b> Bundling package dependencies with <code>renv</code></a></li>
<li class="chapter" data-level="7.6" data-path="masteringpackages.html"><a href="masteringpackages.html#minimizing-package-dependencies"><i class="fa fa-check"></i><b>7.6</b> Minimizing package dependencies</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Learning Guide to R: data, analytical, and programming skills.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="versioncontrol" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Version control with git</h1>
<div id="shouldigit" class="section level2">
<h2><span class="header-section-number">6.1</span> Should I learn version control?</h2>
<p>When you use version control, you can do the following:</p>
<ul>
<li>Keep a history of all the changes you have made to your code.</li>
<li>Be able to revert to an old version, or briefly look around in old code, or find any code you have written at some time in the past.</li>
<li>Undo fatal coding mistakes.</li>
<li>Avoid having multiple versions of the same script (<code>myscrip_v1.R</code>, <code>myscript_v1_mod2.R</code> etc.), and commented-out bits of code that you no longer need.</li>
<li>Collaborate with others on the same code, and easily merge the changes you and your collaborators make.</li>
<li>Maintain an online backup of your code base.</li>
</ul>
<p>These are all basic capabilities of version control, and as you can see an absolute requirement for even the somewhat serious coder. Here we use version control with <em>git</em>, the most popular system. In this chapter, I will give an informal introduction to version control, and focus on its use in Rstudio. The command line will also be introduced, particularly for somewhat more advanced options. The built-in menus in Rstudio are fine for most basic uses, although the use of the command line is recommended when you are committing many files at once (when Rstudio can be very slow and unresponsive).</p>
</div>
<div id="basics-of-git" class="section level2">
<h2><span class="header-section-number">6.2</span> Basics of git</h2>
<div id="basic-principles" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Basic principles</h3>
<p>With git, every folder that you work in can have its own version control repository. This allows you to keep your projects neatly organized in separate folders, each with its own history and set of files that belong together. Organizing code in smaller projects also makes for a natural connection to <em>projects</em> in Rstudio, as we will see shortly.</p>
<p>Not all files in the folder need to be kept track of in the git repository. You can specify yourself which files you want to have under version control. Generally speaking it’s up to you which files to track, but a few guidelines are helpful. Mind you that exceptions will arise for each of these ideas; every project is different.</p>
<ul>
<li>It is useful to follow the idea that <em>input files</em> (code, data) are the most important files in your project, whereas <em>output files</em> (figures, processed data, markdown reports, etc.) should be treated as temporary. If you set up your workflow well, you should always be able to generate all outputs from the inputs. As a result, generally speaking **it is a good idea to version control all input files, but none of your output files}.</li>
<li>Avoid tracking binary files (non-text files). The two reasons are that a) git cannot see incremental changes to these files (only that the entire file has changed), and b) continuously updating larger binary files will increase the size of the git repository (a collection of hidden files storing your history) - eventually to unmanageable bloatedness.</li>
<li>There is no need to track the Rstudio project file (*.Rproj), and probably better if you don’t especially when collaborating.</li>
<li>Text-based datasets can be stored very well in git repositories, but that git is not a data management tool per se. It is therefore a bad idea to include <em>large</em> datasets, only smallish datasets in the repository.</li>
</ul>
<p>You can decide manually which files to track, and you can also “ignore” files by listing them in a special file, <code>.gitignore</code>, as we will see later.</p>
<p>With git, you can ‘store’ a snapshot of all the tracked files in your repository as often as you like. Normally, this snapshot represents a significant change you made to your code, some new feature added, new figures coded, or whatever. It can be any point during your work where you think it may be useful to return to. With every snapshot, you can decide which changes to the tracked files should be included (‘staged’). It is thus <strong>important to realize that a version control repository acts on multiple files in the folder</strong>, not separately for each file. This way we can also add and delete files, and keep track of their histories as well (e.g. return to a version of the repository when a particular file was not deleted).</p>
<p>When we store a snapshot of the repository, this is called a <strong>commit</strong>. When we commit changes to the files in the repository, we do this because we may wish to return to this point, or clearly document the changes we have made. When a commit is made, a message has to be written to document what we have done (as we will see further below). Every time we commit, we can manually select which files should be added to the next snapshot. This process is called <strong>staging</strong>, and it allows you to decide to keep some changes, and undo all other changes, for example.</p>

<div class="rmdreading">
It needs to be stressed that this chapter is a brief non-technical introduction to the topic. It only covers the basic capabilities of git, and stresses the use of Rstudio as an interface to git. You can find many <em>git</em> tutorials online if you want a bit more depth.
</div>

<div id="local-and-remote-repositories" class="section level4">
<h4><span class="header-section-number">6.2.1.1</span> Local and remote repositories</h4>
<p>An important concept when starting with git is that there is a distinction between <strong>local</strong> and <strong>remote</strong> repositories. With git, your version control <strong>is fundamentally done on your computer, that is, it is a local repository</strong>. Optionally, this local repository may be synced with a remote repository (on some online web service). It is thus important to understand that <strong>a)</strong> you do not need to have a remote repository for git to function (you do not need an internet connection) and <strong>b)</strong> you must have a local repository even if you also have a remote one.</p>
<p>Finally, do not confuse ‘github’ with ‘git’, the former is a website (github.com) used for hosting remote git repositories, the latter is the actual version control system. There are other websites of that kind (for example bitbucket.org). The inventor of git has nothing to do with these websites.</p>
</div>
<div id="rstudio-projects-1" class="section level4">
<h4><span class="header-section-number">6.2.1.2</span> Rstudio projects</h4>
<p>If you end up working primarily from Rstudio, we very strongly recommend the use of <strong>Projects</strong> in Rstudio to keep your work organized, and to help set the working directory.</p>
<p>Rstudio projects are really just small files added to a certain folder, which “tags” that folder as containing a particular project. You can switch easily between different projects, or have multiple instances of Rstudio open, all with different projects (something I do a lot). When you switch to a project, <em>it also sets the working directory</em> to the folder where the .Rproj file is located.</p>
<p>We make an Rstudio project in Section <a href="versioncontrol.html#firstgitsession">6.3.1</a> and also return to projects in Section <a href="#rstudioprojects"><strong>??</strong></a>.</p>
</div>
</div>
<div id="installing-git" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Installing git</h3>
<p>To get started, first install the actual git program from <a href="https://git-scm.com/" class="uri">https://git-scm.com/</a>. During the installation process, do not change any of the defaults, just press OK when prompted.</p>
<p>The first time you use git on a computer, you have to set your name and email. These will be appended to each time you commit (very useful when collaborating!).</p>
<p>Normally you can open a ‘git bash shell’ (a command line window) from Rstudio, as we show in Section <a href="versioncontrol.html#commandline">6.6</a>. This first time, however, you <em>might</em> have to find <code>Git Bash</code> in the list of installed programs.</p>
<p>With the shell open, type the following commands, using the name and email address you want appended to each commit. You can change this setting any time, the current setting will be applied to the next commit.</p>
<pre><code>git config --global user.name &quot;My Name&quot;
git config --global user.email &quot;myemail@somewhere.com&quot;</code></pre>
<p>To check the settings configuration file (which is stored in your home directory), use :</p>
<pre><code>git config --list</code></pre>
<p>You can now close the shell. We return to the shell in a later section. The built-in menu’s in Rstudio are fine for 95% of our work with git.</p>
</div>
<div id="using-git-in-rstudio" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Using git in Rstudio</h3>
<p>After installation, Rstudio may have trouble finding the git executable (a reboot may help, but this does not always fix the problem). We can let Rstudio know where git was installed by clicking <code>Browse</code> in the following screenshot (on Windows it will most likely be installed in this exact directory).</p>
<p><img src="screenshots/gitoptionsrstudio.png" width="75%" /></p>
<p><strong>Click <code>Browse</code> to find the directory where git.exe is installed, on Windows it will be this exact directory. You may not have to do this if you rebooted after installing git.</strong></p>
</div>
</div>
<div id="localgit" class="section level2">
<h2><span class="header-section-number">6.3</span> Local git repositories</h2>
<p>Before we turn to remote repositories, we first need a basic understanding of local repositories. Unlike some version control systems, git can work with only a local repository; this can be very useful when you want to commit changes when you are offline.</p>
<p>The workflow with a local git repository is as follows:</p>
<ul>
<li>Make changes to your code</li>
<li>Stage changes, this will mark the changes to the files to be added to the next ‘commit’.</li>
<li>Commit your changes to the local git repository.</li>
<li>Repeat.</li>
</ul>
<div id="firstgitsession" class="section level3">
<h3><span class="header-section-number">6.3.1</span> A first session with version control in Rstudio</h3>
<p>Let’s start a new Rstudio project with version control. In this example we will make a simple local project, with no remote repository defined. We do that in Section <a href="versioncontrol.html#remotegit">6.4</a>.</p>
<p><img src="screenshots/versioncontrolproject.png" width="75%" /></p>
<p><strong>To start a new, local, project with git enabled click ‘New Directory’ (not Version Control!). Alternatively you can use an ‘Existing Directory’ and create a project there.</strong></p>
<p>On the next tab, select <code>Empty Project</code>, and the following window appears. Here, give the project a reasonable name- it will be used to create a new folder if you selected ‘New Directory’ in the above window. Now, also check the box that says ‘Create git repository’.</p>
<p><img src="screenshots/gitnewproject.png" width="75%" /></p>
<p><strong>Enter a name for the new project, the directory where the project will be created (as a sub-directory with the project’s name). Check ‘Create a git repository’ to enable git.</strong></p>
<p>Click OK, and if successful, you wil switch to a new instance of Rstudio. The git tab should look like the following figure.</p>
<p><img src="screenshots/gittabnewproject.png" width="75%" /></p>
<p><strong>What your git tab should look like if you started an empty project in a new directory.</strong></p>
<p>The two files in the folder show up with two question marks. This means that git is not sure if you want to track these files. By default, it won’t track them. The <code>.gitignore</code> file is a special file that lists all the files you always will want to ignore. It is very useful and we will use it later.</p>
<p>Now, let’s open two new scripts and write some code. I have called my new scripts <code>analysis.R</code> and <code>figures.R</code>. As you expect, these two files will show up in the git tab with two question marks. Notice the <code>Staged</code> column in the above figure? Let’s stage both files by checking them, as in the below figure.</p>
<p><img src="screenshots/gittabnewproject.png" width="75%" /></p>
<p><strong>Two new files are staged for the next commit. The green ‘A’ means ‘Add’, because these files were not already being tracked by the git repository.</strong></p>
<p>We will now make our <strong>first commit</strong>. With the files staged as in the screenshot, click the ‘Commit’ button.</p>
<p><img src="screenshots/gitfirstcommit.png" width="75%" /></p>
<p><strong>With the two new files staged, you can commit their changes to the local git repository. You must first write a meaningul message in the box on the right.</strong></p>
<p>The files will now have disappeared from the git tab. That’s good - their versions are the same as the last time you committed, that is, they have not changed in content. Now let’s modify <code>analysis.R</code>, and delete <code>figures.R</code> (maybe you decided to combine code from these files into a single file), and see what happens.</p>
<p><img src="screenshots/gitsecondcommit.png" width="75%" /></p>
<p><strong>Here we have modified (M) and deleted (D) files that are being tracked by git.</strong></p>
<p>Now, stage both files, and press Commit. Write a message that briefly describes your changes and click ‘Commit’ in the next window as well:</p>
<p><img src="screenshots/secondcommit.png" width="75%" /></p>
<p><strong>With the modified and deleted file selected, write a message and click Commit.</strong></p>
<p>Let’s now look at the history of our first project sofar. Find the ‘History’ button in the git tab. It will look like the following screenshot.</p>
<p><img src="screenshots/firsthistory.png" width="75%" /></p>
<p><strong>History of the project sofar. The HEAD tag means this is the current location of the working directory. As we will see later, we can check out older versions, in which case HEAD will move to whatever commit we are looking at. Shown are the messages we wrote when committing, the author and date (taken from the git configuration), and the SHA.</strong></p>
<p>The ‘SHA’ is the unique code given to each commit. You normally don’t have to use it in Rstudio, but it is important in the command line commands given below. We never need all characters from the SHA, only the first few (normally 5 or so). You can find the (abbreviated) SHA in the right-hand column of the history.</p>
<p>The question marks for <code>.gitignore</code> and the <code>Rproj</code> indicate that these files have not been staged in any previous commit. If you do not want to ever track them, see Section <a href="versioncontrol.html#gitignore">6.5</a>.</p>
</div>
<div id="deleting-files-and-sensitive-information" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Deleting files and sensitive information</h3>
<p>Some new users are surprised by how git deals with deleting files in your repository. If you delete a file, git will mark the file as deleted (with a red D in the Rstudio interface), and you can stage the change to also remove the file from git (so it won’t be tracked anymore). Even though the file is deleted, it is still contained in the <em>history</em> of your repository. That means you (or someone else) can return to a state of the repository that included the file, and read its contents.</p>
<p>If you accidentally committed a file with sensitive information, such as passwords, deleting the file does not remove it from the history. There is also a way to completely remove files, even from the history, but this is a bit cumbersome and best avoided. Normally we do not like to change history unless some of the files are very large or contain sensitive information.</p>
</div>
<div id="reverting-changes" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Reverting changes</h3>
<p>To undo changes to files in Rstudio, and reset to the last known version of that file (i.e. the the last commit), select the file and click the ‘Revert’ button (this button is only visible in the Commit window, otherwise it is grouped under the ‘More’ button).
Sometimes this menu in Rstudio is a little <em>buggy</em>, reverting only one file at a time.</p>
<p>If you are <strong>100% sure you have made commits you want to delete forever</strong>, see Section <a href="versioncontrol.html#commandline">6.6</a> for the use of <code>git reset --hard</code>.</p>
</div>
</div>
<div id="remotegit" class="section level2">
<h2><span class="header-section-number">6.4</span> Remote git repositories</h2>
<p>Version control with git becomes especially useful if you host your code in an online (‘remote’) repository. It is an essential step for collaboration (even if this is just with yourself, on multiple computers). Popular sites to host git repositories are &lt;www.github.com&gt; and &lt;www.bitbucket.org&gt;. I will not provide a guide to using either site, I will leave this to you to figure out. Either way, the first step is to create a user account, and set up the remote to be able to communicate with your computer.</p>
<p>A few tips to get started:</p>
<ul>
<li>A remote repository is simply a copy of your local project, think of it as a backup (with few extras).</li>
<li>It is generally a good idea to organize your local repositories in a single directory, a location with a short path is useful since you will be accessing your repositories via the command line.</li>
<li>You can add git version control to an existing project, but the easiest, most fail-safe way is to create a remote repository, then make a new project in Rstudio pulling from that repository, and adding your files into the project. We will follow this approach below.</li>
</ul>
<div id="https-or-ssh" class="section level4">
<h4><span class="header-section-number">6.4.0.1</span> HTTPS or SSH?</h4>
<p>There are two ways to connect to a git repository hosted on a remote (like github). The easiest setup is connecting via HTTPS, but this will require you to enter your password every time you try to update the remote. I recommend HTTPS only when you are using a public computer.</p>
<p>A better approach is to use SSH, since you never have to type your password - a sort of password will be saved on your computer.</p>
</div>
<div id="setting-up-ssh" class="section level4">
<h4><span class="header-section-number">6.4.0.2</span> Setting up SSH</h4>
<p>If you are using SSH for authentication, you must first make a sort of password (an ‘SSH key’), which is stored on your computer as well as on the hosting site. This is a straightforward process thanks to Rstudio.</p>
<ul>
<li>Go to <code>Tools/Global Options...</code> then click on the <code>Git/SVN</code> button, and note the ‘SSH/RSA key’ field.</li>
<li>This field is probably blank, now click on <code>Create RSA Key</code>. Leave the passphrase blank (unless you would like an extra layer of security), and click OK.</li>
<li>Next, click ‘View RSA Key’ (a small link), and copy the key (Ctrl-C).</li>
</ul>
<p>The next step is to paste the SSH key in the remote hosting site, so it knows who you are when you try to use the repository.</p>
<p>On bitbucket, when logged in, click ‘Manage Account’, and find ‘SSH Keys’ on the left. Then click ‘Add Key’, and you now have to paste the key that you copied in the previous step.</p>
<p>On github, go to Settings/SSH and GPG keys and make a “New SSH key”, and paste it in as above.</p>
<p>You can now paste it into the field. Also add a nice label for the key (identifying the computer you are working on).</p>
</div>
<div id="makeremotegit" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Making a remote repository</h3>
<p>Now, let’s create a remote repository. On bitbucket (when you are logged in), click the “+” in the left-hand side menu, on github click the plus (‘+’) button in the top right and <code>Create repository</code>. Decide for yourself on the settings for the repository, such as Private/Public etc.</p>
<p>The key thing for us is to find the address of the repository, we need this to use the remote in Rstudio. When using SSH, it will look like (on bitbucket):</p>
<pre><code>git@bitbucket.org:remkoduursma/tutorialgit.git</code></pre>
<p>When using HTTPS, it will look like this:</p>
<pre><code>https://remkoduursma@bitbucket.org/remkoduursma/tutorialgit.git</code></pre>
<div id="adding-a-remote-repository-to-an-existing-project" class="section level4">
<h4><span class="header-section-number">6.4.1.1</span> Adding a remote repository to an existing project</h4>
<p>To do this, you have to use the command line. If you want to use only Rstudio’s menu’s, skip to the next section.</p>
<p>With the command line (bash) open in the working directory, type the following two commands where you replace the <em>github</em> URL with the one matching your remote repository.</p>
<pre><code>git remote add origin git@github.com:USERNAME/REPOSITORY.git
git push -u origin master</code></pre>
<p>The remote repository will now be an exact copy of your local one (besides untracked files).</p>
</div>
<div id="cloning-make-a-local-copy-of-a-remote-repository" class="section level4">
<h4><span class="header-section-number">6.4.1.2</span> Cloning : make a local copy of a remote repository</h4>
<p>The easiest approach is to start with an empty remote repository and use it as the basis for a new project in Rstudio. Then, you can add your files to this repository and start tracking (a selection of) them.</p>
<p>First, make a remote repository, find the address (SSH or HTTPS, see previous section), and copy it. In Rstudio, go <code>File/New Project.../Version Control/Git</code> and paste the address in the URL box (HTTPS or SSH, it will be recognized). Rstudio is going to create a (nearly empty) folder with a git repository. It will create this as a subfolder of the directory in the window you see (the third field). I recommend you keep your git repositories in a local folder in the root, <strong>that contains no spaces in the name</strong>. For example, <code>c:/repos/</code>.</p>
<p><img src="screenshots/clonegitrepos.png" width="75%" /></p>
<p><strong>Paste the remote address of the repository in the first field, the second field will automatically get the name of the remote repository, and for the third field select a directory yourself (but see text).</strong></p>
<p>When you click OK, Rstudio should open up with the new project.</p>
</div>
</div>
<div id="gitremoteworkflow" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Workflow</h3>
<p>Whether or not you have a remote repository enabled, you will still work in a local repository as explained in Section <a href="versioncontrol.html#localgit">6.3</a>, and occassionally synchronize the two. In other words, <strong>committing changes is always local</strong>. When you want to sync with a remote, you either do a <strong>push</strong> (send your commits to the remote repository), or a <strong>pull</strong> (get the latest commits from the remote that you don’t have).</p>
<p>It is important to note that <strong>you can only push if the local up to date with remote</strong>. We will see in the working example how to deal with the situation where we are ‘behind’ the remote (that is, have not included some commits stored in the remote repository).</p>
<p>The standard workflow for code stored in a remote repository is:</p>
<ol style="list-style-type: decimal">
<li>Pull - this makes sure you start with the version contained in the remote repository.</li>
<li>Write code, commit changes.</li>
<li>Repeat step 2. until you are finished with this session.</li>
<li>Push - this sends all the commits you made to the remote repository.</li>
</ol>
<p>It is thus important to understand that <strong>you don’t have to push every time you commit changes</strong>. In fact it is better if you don’t, because it is easier to fix problems in the local repository, than when the commits have been pushed to the remote.</p>
</div>
<div id="a-session-with-a-remote-repository" class="section level3">
<h3><span class="header-section-number">6.4.3</span> A session with a remote repository</h3>
<p>In this section, I will show a typical workflow with a remote repository. In this example I assume you have made a remote repository, and we will clone the empty repository into a new Rstudio project (see ‘Cloning’ in Section <a href="versioncontrol.html#makeremotegit">6.4.1</a>.</p>
<p>If these first two steps - explained in the previous section - were successful, you now have a new, empty project open in Rstudio. I have copied two scripts that I wrote previously into the folder. In the git tab in Rstudio, you have to ‘stage’ the added files by clicking the check box. The two new files now show up with a green ‘A’ :</p>
<p><img src="screenshots/session2stage1.png" width="75%" /></p>
<p><strong>Adding two files to be included in the next commit. Note that ‘Push’ and ‘Pull’ are greyed out, this is normal because we have no commits in the repository.</strong></p>
<p>Next, click commit (opens up a new window), write a reasonable message in the text box on the right, and click ‘Commit’. You now have a single commit in the <strong>local</strong> repository. Again, it is crucial you understand that this commit is not yet on the remote.</p>
<p>Let’s <strong>push</strong> this first commit to the remote repository. Just click ‘Push’ on the git tab, and a new window opens up in Rstudio with the response from the remote. It will say something like,</p>
<p><img src="screenshots/session2firstpush.png" width="75%" /></p>
<p><strong>Response of the remote after the first push (opens in Rstudio when you click ‘push’). Note that a new branch is created because this is the very first commit on the remote repository. All commits will always go to the ‘master’ branch (in this tutorial, at least).</strong></p>
<p>Now go to the online version (on github.com or bitbucket.org), and check that your code is really there. Also look for the ‘commits’ (a list of all your commits) and the source code (you can, quite conveniently, browse the code online).</p>
<p>Next, suppose you start a new session with this project. As described in Section <a href="versioncontrol.html#gitremoteworkflow">6.4.2</a>, you should always start with a <strong>pull</strong>, except when you are really 100% sure that your local is already up to date with the remote. If you are already up to date, the output will be:</p>
<p><img src="screenshots/session2pullalreadyuptodate.png" width="75%" /></p>
<p><strong>Output from a ‘pull’ when the local repository is already synced with the remote.</strong></p>
<p>In the next example, I added the file <code>README.md</code> to the repository on another computer. This time, the output from ‘pull’ looks like:</p>
<p><img src="screenshots/session2pull.png" width="75%" /></p>
<p><strong>Output from a ‘pull’ when the local repository is behind the remote. This is a successful message. It says that the two repositories have been successfully merged.</strong></p>
<p>Finally, a common situation arises where you have not pulled from the remote, have done work locally and committed the changes. It is possible that the remote includes changes that you don’t have, for example commits created by a collaborator and pushed to the same remote repository, or work done by you on another computer. If the remote is ahead of you, and you are trying to push local commits that the remote does not yet have, you will see the output as in the following screenshot.</p>
<p><img src="screenshots/session2pushbehind.png" width="75%" /></p>
<p><strong>Output when attempting to push to a remote when the remote is ahead of the local repository.</strong></p>
<p>The solution to this problem is to first do a pull, and then try to push again. The amazing thing about git is that even if your local commits and the commits on the remote that you don’t yet have include changes on the same files, they will be automatically merged in the new commit.</p>
</div>
<div id="conflicts-when-collaborating" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Conflicts when collaborating</h3>
<p>Version control is especially powerful when collaborating on the same code. When you work on separate files, or even different sections of the same file, git knows how to combine commits from one user with commits from another user. You can even see who changed which line of code with the <code>git blame</code> command.</p>
<p>There are cases, however, where <strong>conflicts</strong> arise when two users have changed the same line of code. Suppose User 1 makes changes, commits, and pushes to the remote. Then, you make changes to some of the same lines, commit and push, you receive the following error:</p>
<p><img src="screenshots/gitpullconflict.png" width="75%" /></p>
<p><strong>When pushing your changes to the remote - but the remote has already incorporated commits on the same lines of code - you have created conflicts</strong></p>
<p>You now have to fix the conflicts in the code - hoping there are only a few. Look in the Git pane in Rstudio to see which files have conflicts (they will be marked with an orange U), and then look for sections of code that look like this:</p>
<p><img src="screenshots/gitconflictfixing.png" width="75%" /></p>
<p><strong>Code conflicts are automatically marked by git. Notice how there are two versions of the same line of code, above and below line 21</strong></p>
<p>Now, simply fix the code by keeping the version you want - make sure to delete all extra code that git has added, commit the file, and push.</p>
<p>It is however much better to avoid these conflicts by always <strong>beginning your session with a pull, and ending with a push</strong>. That way you minimize the risk of changing the same line of code twice.</p>
</div>
</div>
<div id="gitignore" class="section level2">
<h2><span class="header-section-number">6.5</span> Ignoring files</h2>
<p>As discussed, you don’t want all of your local files to be copied to the remote repository. These include private data, large files, most binary files, sensitive information like passwords.</p>
<p>You can keep a list of files to ignore in the file <code>.gitignore</code>, which will most likely already be generated for you in the working directory.</p>
<p>Here is an example, with some useful settings</p>
<pre><code># No need to track the Rproj file
*.Rproj

# Private data: all files in data/ and config/
data/
config/

# Ignore all these types
*.xlsx
*.pdf

# ... except this file
!public_result.pdf</code></pre>
<p>You can inspect which files are being tracked with the command line:</p>
<pre><code>git ls-files</code></pre>
<p>It is also always a good idea to inspect the remote repository to see if anything was uploaded you did not want to share. If you accidentally do push passwords to a remote repository, the best way is to <strong>delete the remote repository and make a new one with the same name</strong>.</p>
</div>
<div id="commandline" class="section level2">
<h2><span class="header-section-number">6.6</span> Using the command line</h2>
<p>Rstudio is very convenient for day-to-day version control, but for more advanced options, you must know how to use the command line. You may also find that when you gain more <em>git skills</em>, that using the command line is just as convenient while providing more control.</p>
<p>First, we show you how to open the ‘shell’, a command window where the full capabilities of git can be used.</p>
<p><img src="screenshots/openshell.png" width="75%" /></p>
<p><strong>From the ‘Git’ tab in Rstudio (same pane as Environment and History), open the Shell like this.</strong></p>
<p>The shell is different from the Windows command line! It comes installed with git, and recognizes most unix commands.</p>
<p>Note that **if the output is longer than the screen, output will end with a ‘:’. In that case, press <code>q</code> to return to the command prompt}.</p>
<div id="basic-commands" class="section level3">
<h3><span class="header-section-number">6.6.1</span> Basic commands</h3>
<p>When using the command line, you will often repeat this command:</p>
<pre><code>git status</code></pre>
<p>The output is basically what you see in the Git pane in Rstudio, but in text instead of colored icons (sometimes it is easier to understand what is happening!):</p>
<p><img src="screenshots/gitstatus.png" width="75%" /></p>
<p>In this example, we have two commits locally that we have not pushed yet, and one previously commited file that has been modified.</p>
<p>If you want to commit from the command line, the first step is to <strong>stage</strong> the files for the next commit. This is equivalent to using the check boxes in the Git pane in Rstudio. To stage all files that have previously been commited (that is, the files that are being tracked by git in this repository):</p>
<pre><code>git add -u</code></pre>
<p>This command is equivalent to checking all check boxes in Rstudio, <em>except</em> the ones with a question mark (untracked files). This is the preferred command, because you will never commit files you do not want to commit (remember to keep a close eye on the <code>.gitignore</code> file!). If you are sure you want to stage all files that git “sees” (i.e. not in <code>.gitignore</code>), use the command:</p>
<pre><code>git add .</code></pre>
<p>This command is equivalent to checking <em>all</em> check boxes (including the question marks) in Rstudio.</p>
<p>With files staged (remember to first look at <code>git status</code>, repeat that after every step!), you can commit with:</p>
<pre><code>git commit -m &quot;improved config files&quot;</code></pre>
<p>Writing a commit message is mandatory.</p>
<p>To see if you have a remote repository configured (and where), use the command:</p>
<pre><code>git remote -v</code></pre>
<p><img src="screenshots/gitremotev.png" width="75%" /></p>
<p>You can now push to the remote with,</p>
<pre><code>git push</code></pre>
<p>If there are no conflicts, you are done. See advanced examples below for pushing to a remote when you want to overwrite what is on the remote with local changes.</p>
<p>To pull changes from the remote, obviously:</p>
<pre><code>git pull</code></pre>
</div>
<div id="useful-tasks" class="section level3">
<h3><span class="header-section-number">6.6.2</span> Useful tasks</h3>
<p>This section lists a number of useful things you can do with git from the command line. It is by no means exhaustive.</p>
<div id="history" class="section level4">
<h4><span class="header-section-number">6.6.2.1</span> History</h4>
<p>Look at the history of the repository with,</p>
<pre><code>git log</code></pre>
<p>which lists each commit (and its SHA and commit message). If you only want to see the last, say 2 commits, do,</p>
<pre><code>git log -2</code></pre>
<p>and remember to press <code>q</code> when the output is longer than the window to return to the prompt.</p>
</div>
<div id="adding-a-remote-to-a-local-repository" class="section level4">
<h4><span class="header-section-number">6.6.2.2</span> Adding a remote to a local repository</h4>
<p>Suppose you have a local project as the example workflow in Section <a href="versioncontrol.html#firstgitsession">6.3.1</a>, and you want to start a remote repository. You now simply have to let git know that you have a remote as well. To do this, you have to open a Console (see Section <a href="versioncontrol.html#commandline">6.6</a>) and use this command:</p>
<pre><code>git remote add origin git@bitbucket.org:remkoduursma/tutorialgit.git</code></pre>
<p>where the right-hand side is the address of your remote (found in the last section).</p>
<p>Then, make your changes as usual, and use this special <code>push</code> command the first time you push to the remote (after that, you can do the usual simple ‘git push’).</p>
<pre><code>git push -u origin master</code></pre>
</div>
<div id="list-all-tracked-files" class="section level4">
<h4><span class="header-section-number">6.6.2.3</span> List all tracked files</h4>
<p>If you are unsure which files are being tracked, you could browse the remote repository (if you have one), or use this command:</p>
<pre><code>git ls-files</code></pre>
</div>
<div id="looking-around-in-an-old-version" class="section level4">
<h4><span class="header-section-number">6.6.2.4</span> Looking around in an old version</h4>
<p>Perhaps you don’t actually want to undo changes, but instead inspect some older code, from which you can copy-paste bits you accidentally deleted. We can use the <code>checkout</code> command for this, which let’s you temporarily look at an old commit.</p>
<p>First we find the SHA of the commit, either in the history (in Rstudio), or via <code>git log</code> as shown above.</p>
<pre><code>git log -2</code></pre>
<p>Now suppose we want to ‘check out’ (look around and browse) the commit with SHA <code>fbd966</code> (recall, you only ever need the first 5 or 6 characters of the commit).</p>
<pre><code>git checkout fbd966</code></pre>
<p>It is crucial you understand that you can now only look around, but you have not reverted to this old version! This is very useful to take a look at old code, maybe copy some bits and pieces to a new file, and then return to the current version. To make sure you know this, git tells you as much:</p>
<p><img src="screenshots/gitcheckoutoutput.png" width="75%" /></p>
<p><strong>Output of the command line after doing a checkout. Basically git is trying to tell you your visit to this old version of the code is for looking around only.</strong></p>
<p>To return back to the current, last version, do:</p>
<pre><code>git checkout master</code></pre>
</div>
<div id="undoing-uncommited-changes" class="section level4">
<h4><span class="header-section-number">6.6.2.5</span> Undoing uncommited changes</h4>
<p>Suppose you have committed your work, then made a bunch more changes that you are very unhappy with. But, luckily, you haven’t committed them yet. You can use the ‘Revert’ button in Rstudio (as mentioned previously), but this really removes any chance that you <em>maybe</em> want to use the new edits.</p>
<p>Using the command line, you can use the <code>git stash</code> command as follows:</p>
<pre><code>git stash</code></pre>
<p>The files will not automatically appear as they were in the last commit. The advantage of using <code>stash</code> here - instead of the Revert button in Rstudio - is that if you change your mind you can do <code>git stash apply</code>. Basically your uncommitted changes are kept in a ‘stash’, not deleted.</p>
</div>
<div id="deleting-the-last-commit" class="section level4">
<h4><span class="header-section-number">6.6.2.6</span> Deleting the last commit</h4>
<p>Suppose you have made changes, committed them, and then found out these are terrible and you want to get rid of them. We can use the <code>reset</code> command. <strong>Use this at your own risk, it cannot be undone!</strong>.</p>
<p>First let’s look at the last two commits,</p>
<pre><code>git log -2</code></pre>
<p>So we want to get rid of commit <code>f76gb</code>, and revert back to <code>hu88e</code>.</p>
<pre><code>git reset --hard hu88e</code></pre>
<p>Instead of <code>--hard</code>, you can use the <code>--soft</code> option to revert back to the old commit, but keep the changes since then as unstaged changes to the files. This is useful if you want to keep some of the changes, but manually remove or fix some other changes.</p>
</div>
<div id="force-updating-the-remote" class="section level4">
<h4><span class="header-section-number">6.6.2.7</span> Force-updating the remote</h4>
<p>Sometimes your local version of the code is the only correct version, and you want to completely overwrite the remote repository. This arises when you did a “hard reset” to an old commit as in the previous section. If you are sure you want to overwrite the remote, do:</p>
<pre><code>git push --force</code></pre>
<p>Be careful, there is no “undo” option.</p>
</div>
<div id="deleting-files" class="section level4">
<h4><span class="header-section-number">6.6.2.8</span> Deleting files</h4>
<p>We already saw that when you delete a tracked file from a git repository, you have to stage the change just like you stage a modification to a file. Here are a couple of useful commands related to deleting files locally.</p>
<p>Remove from local repository (i.e. stop tracking) all locally deleted files:</p>
<pre><code>git rm $(git ls-files --deleted)</code></pre>
<p>The next command is handy to clean your working directory. Use this at your own risk though!</p>
<p>Delete all untracked files:</p>
<pre><code>git clean -f</code></pre>
<p>To do the same, but include subdirectories (use this at even more own risk!):</p>
<pre><code>git clean -f -d</code></pre>
</div>
<div id="searching-the-history" class="section level4">
<h4><span class="header-section-number">6.6.2.9</span> Searching the history</h4>
<p>There are a few ways to search the history - all of them require the command line. It may be useful to find code you deleted (on purpose), or to find all the occassions where some word occurs in changed lines of code, or list all the commits that acted on a particular file.</p>
<p>Find all commits with ‘someword’ in the commit message.</p>
<pre><code>git log --grep=someword</code></pre>
<p>Find all commits where ‘someword’ occurs in changed lines of code</p>
<pre><code>git log -G someword</code></pre>
<p>List all commits that include changes on ‘somefile.R’. This even works when the file was deleted at some point.</p>
<pre><code>git log -- somefile.R</code></pre>
</div>
<div id="accessing-git-help-files" class="section level4">
<h4><span class="header-section-number">6.6.2.10</span> Accessing git help files</h4>
<p>You can learn more about the many options of git via the help files, each of these can be accessed like this.</p>
<p>Show help file for ‘log’.</p>
<pre><code>git log --help</code></pre>
<p>Perhaps more usefully, if you don’t know how to do something in git, simply type your question in Google (“git how to delete untracked files”).</p>
</div>
</div>
</div>
<div id="branches" class="section level2">
<h2><span class="header-section-number">6.7</span> Branches</h2>
<p>A powerful feature of git is the ability to maintain parallel versions of code, with the use of branches. A branch (not to be confused with a fork!) keeps its own history of commits, separate from the main branch (usually called the <strong>master</strong> branch). At the point when you make the new branch, the master and the new branch are identical - but when you are working on the new branch, changes files and commit - the two will have different histories.</p>
<p>Branches are very useful for working on alternative versions of your working code base on the master branch. For example, when other users depend on your master branch working (and not being polluted with experimental code), but your new changes will take a long time - and multiple commits - to complete.</p>
<p>To make a new branch, I prefer the use of a small button in Rstudio :</p>
<p><img src="screenshots/gitbranchbutton.png" width="75%" /></p>
<p>When you click the button, a menu opens up:</p>
<p><img src="screenshots/gitnewbranch.png" width="75%" /></p>
<p>Keep the checkbox checked if you want the branch to also push to the remote (this is usually what you want, though it can be useful to keep a very experimental branch on your computer only).</p>
<p>Ater you click OK, a new branch will be created locally and on the remote :</p>
<p><img src="screenshots/gitnewbranchsuccess.png" width="75%" /></p>
<p>This indicates a successful new branch.</p>
<p>You can now work on the new branch as you would on the master branch. Note the label in the topright of the git pane in Rstudio to see which branch you are currently working on.</p>
<p>Git hosting sites like github support multiple branches in a single repository as well, for example here is a repository with two branches:</p>
<p><img src="screenshots/githubbranches.png" width="75%" /></p>
<p>Branches are best for working on experimental new changes for which you intend to include them in the master branch, at some point, or otherwise abandon the experiment and delete the branch. When you want to update the master branch to include changes from the new branch, you must use the command line and first “checkout” the master branch (this can also be done in the Rstudio git pane),</p>
<pre><code>git checkout master</code></pre>
<p>then, merge the new branch:</p>
<pre><code>git merge newbranch
``

Just like working with remotes, it is possible you have produced conflicts that may need to be fixed.










&lt;!--chapter:end:18-versioncontrol.Rmd--&gt;

# Project management and workflow {#projectman}



 
## Tips on organizing your code

In this chapter, we present a few tips on how to improve your workflow and organization of scripts, functions, raw data, and outputs (figures, processed data, etc.). The structure that we present below is just an example, and will depend on the particular project, your requirements, how much time you have, and personal preference. 

The main **challenge** in developing more complex workflows, where you have multiple data sources, scripts for various analyses, and outputs of various kinds (figures, markdown documents, prepared data etc.) is to keep things organized, avoid *clutter*, and make sure you know how the outputs were produced.

All projects are different, and we encourage you to experiment with different workflows and organization of your script(s) and outputs. 

The following is a **rule of thumb** list for R project management:

- Use &#39;projects&#39; in Rstudio to manage your files and workspace.
- Use *git* version control (see Chapter \@ref(versioncontrol)).
- Use a logical folder structure inside your projects, keeping similar files together (data, scripts, output, etc.).
- Avoid writing long scripts, instead break them into a logical collection of shorter scripts.
- Load all required packages in a separate script.
- Outputs (figures, processed datasets) are *disposable*, your scripts can always re-produce the output.
- Keep function declarations separate from other code.
- Write functions as much as possible.
- Add a &#39;README.md&#39; file to your project, markdown-formatted file explaining what the project does, a list of any dependencies, how to run the code, where to find the output, etc.


In this chapter we show an example project structure, which uses most of the above rules to come up with a transparent project workflow. If you follow (something like) the structure we show here, you have the added benefit that your directory is fully portable. That is, you can zip it, email it to someone, they can unzip it and run the entire analysis. 

For effective project management we find using custom functions to organize our work most useful. See Chapter \@ref(programming) for general introduction to functions, and Section \@ref(scriptstructure) on how to organize your code with functions.


## Set up a project in Rstudio {#rstudioprojects}

The most important tip is to *use projects in Rstudio*. Projects are an efficient method to keep your files organized, and to keep all your different projects separated. There is a natural tendency for analyses to grow over time, to the point where they become too large to manage properly. The way we usually deal with this is to try to split projects into smaller ones, even if there is some overlap between them. 

\BeginKnitrBlock{rmdcaution}&lt;div class=&quot;rmdcaution&quot;&gt;Stop using `setwd()` in any of your scripts. This is never a good idea, for various reasons. Instead use Rstudio projects as a way to set the working directory automatically (and cleanly).

You can also stop using `rm(list=ls())` in any of your scripts. The problem with this command is that it does not clean *everything* : all packages are still loaded, and hidden objects also remain (ones starting with `.`), and certain `options` may have been set. Instead, test reproducing your project by selecting `Session/Restart R` and running the project.&lt;/div&gt;\EndKnitrBlock{rmdcaution}


In Rstudio, click on the menu item `File/New Project...`. If you already have a folder for the project, take the 2nd option (`Existing directory`), otherwise create a folder as well by choosing the 1st option (`New project`). We will discuss &quot;version control&quot; in the next chapter.

Browse for the directory you want to create a project in, and click `Choose`. This creates a file with extension `.Rproj`. Whenever you open this project, Rstudio will set the working directory to the location of the project file. If you use projects, you no longer need to set the working directory manually as we showed in Section \@ref(fileswd).

Rstudio has now switched to your new project. Notice in the top-right corner there is a button that shows the current project. For the example project &#39;facesoil&#39;, it looks like this:

&lt;img src=&quot;screenshots/projectbutton.png&quot; width=&quot;30%&quot; /&gt;

**The Project button in Rstudio**

By clicking on that button you can easily switch over to other projects. The working directory is automatically set to the right place, and all files you had open last time are remembered as well. As an additional bonus, the workspace is also cleared. This ensures that if you switch projects, you do not inadvertently load objects from another project.


## Directory structure

For the &#39;facesoil&#39; project, we came up with the following directory structure. Each item is described further below.

&lt;img src=&quot;screenshots/folderstructure.png&quot; width=&quot;70%&quot; /&gt;

**Folder structure; just an example**


### `rawdata`

If your project contains any raw data files (within ) *keep your raw data separate from everything else*. Here we have placed our raw CSV files in the `rawdata` directory.

In some projects it makes sense to further keep raw data files separate from each other, for example you might have subfolders in the rawdata folder that contain different types of datasets (e.g. &#39;rawdata/leafdata&#39;, &#39;rawdata/isotopes&#39;). Again, the actual solution will depend on your situation, but it is at least very good practice to store your raw data files in a separate folder.

### `Rfunctions`

If you do not frequently write functions already, you should force yourself to do so. Particularly for tasks that you do more than once, functions can greatly improve the clarity of your scripts, helps you avoid mistakes, and makes it easier to reuse code in another project. 

It is good practice to keep functions in a separate folder, for example `Rfunctions`, with each function in a separate file (with the extension `.R`). It may look like this,

&lt;img src=&quot;screenshots/rfunctions.png&quot; width=&quot;70%&quot; /&gt;

**Contents of Rfunctions folder, example.**

We will use `source()` to load these functions, see further below.

### `output`

It is a good idea to send all output from your R scripts to a separate folder. This way, it is very clear what the *outputs* of the analysis are. It may also be useful to have subfolders specifying what type of output it is. Here we decided to split it into figures, processeddata, and text :

&lt;img src=&quot;screenshots/output.png&quot; width=&quot;70%&quot; /&gt;

**Contents of output folder, example.**


## The R scripts

A few example scripts are described in the following sections. Note that these are just examples, the actual setup will depend on your situation, and your personal preferences. The main point to make here is that it is tremendously useful to separate your code into a number of separate scripts. This makes it easier to maintain your code, and for an outsider to follow the logic of your workflow.

### `facesoil_analysis.R`

This is our &#39;master&#39; script of the project. It calls (i.e., executes) a couple of scripts using `source`. First, it &#39;sources&#39; the `facesoil\_load.R` script, which loads packages and functions, and reads raw data. Next, we do some analyses (here is a simple example where we calculate daily averages), and call a script that makes the figures (`facesoil_figures.R`).

Note how we direct all output to the `output` folder, by specifying the *relative path*, that is, the path relative to the current working directory.


```r
# Calls the load script.
source(&quot;facesoil_load.R&quot;)

# Export processed data
write.csv(allTheta, &quot;output/processeddata/facesoil_allTheta.csv&quot;,
          row.names=FALSE)

## Aggregate by day

# Make daily data
allTheta$Date &lt;- as.Date(allTheta$DateTime)
allTheta_agg &lt;- summaryBy(. ~ Date + Ringnr, data=allTheta,
                          FUN=mean, keep.names=TRUE)

# Export daily data
write.csv(allTheta_agg, &quot;output/processeddata/facesoil_alltheta_daily.csv&quot;,
          row.names=FALSE)

## make figures
source(&quot;figures.R&quot;)</code></pre>
<div id="facesoil_figures.r" class="section level3">
<h3><span class="header-section-number">6.7.1</span> <code>facesoil_figures.R</code></h3>
<p>In this example we make the figures in a separate script. If your project is quite small, perhaps this makes little sense. When projects grow in size, though, I have found that collecting the code that makes the figures in a separate script really helps to avoid clutter.</p>
<p>Also, you could have a number of different ‘figure’ scripts, one for each ‘sub-analysis’ of your project. These can then be sourced in the master script (here <code>facesoil\_analysis.R</code>), for example, to maintain a transparent workflow.</p>
<p>Here is an example script that makes figures only. Note the use of <code>dev.copy2pdf</code>, which will produce a PDF and place it in the <code>output/figures</code> directory.</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="versioncontrol.html#cb754-1"></a><span class="co"># Make a plot of soil water content over time</span></span>
<span id="cb754-2"><a href="versioncontrol.html#cb754-2"></a><span class="kw">pdf</span>(<span class="st">&quot;./output/figures/facesoil_overtime.pdf&quot;</span>)</span>
<span id="cb754-3"><a href="versioncontrol.html#cb754-3"></a><span class="kw">with</span>(allTheta, <span class="kw">plot</span>(DateTime, R30.mean, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">0.2</span>,</span>
<span id="cb754-4"><a href="versioncontrol.html#cb754-4"></a>                    <span class="dt">col=</span>Ringnr))</span>
<span id="cb754-5"><a href="versioncontrol.html#cb754-5"></a><span class="kw">dev.off</span>()</span>
<span id="cb754-6"><a href="versioncontrol.html#cb754-6"></a></span>
<span id="cb754-7"><a href="versioncontrol.html#cb754-7"></a><span class="co"># More figures go here!</span></span></code></pre></div>
<p>The above is OK, but we can do better by writing it into a function, and then calling it to make the PDF. Even better, the PDF making can be done Here we also use <code>on.exit</code> to safely close the PDF, see Section @ref(onexit.</p>
<p>Like so,</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="versioncontrol.html#cb755-1"></a><span class="co"># A function that defines our plot</span></span>
<span id="cb755-2"><a href="versioncontrol.html#cb755-2"></a><span class="co"># Write functions like these, and collect them in a separate script,</span></span>
<span id="cb755-3"><a href="versioncontrol.html#cb755-3"></a><span class="co"># for example &quot;figure_definitions.R&quot;.</span></span>
<span id="cb755-4"><a href="versioncontrol.html#cb755-4"></a>soilplot_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(data){</span>
<span id="cb755-5"><a href="versioncontrol.html#cb755-5"></a>  <span class="kw">with</span>(data, <span class="kw">plot</span>(DateTime, R30.mean, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">0.2</span>,</span>
<span id="cb755-6"><a href="versioncontrol.html#cb755-6"></a>                    <span class="dt">col=</span>Ringnr))  </span>
<span id="cb755-7"><a href="versioncontrol.html#cb755-7"></a>}</span>
<span id="cb755-8"><a href="versioncontrol.html#cb755-8"></a></span>
<span id="cb755-9"><a href="versioncontrol.html#cb755-9"></a><span class="co"># A generic function that makes a PDF of a provided function call</span></span>
<span id="cb755-10"><a href="versioncontrol.html#cb755-10"></a><span class="co"># Place this function in a script with a collection of functions.</span></span>
<span id="cb755-11"><a href="versioncontrol.html#cb755-11"></a>to.pdf &lt;-<span class="st"> </span><span class="cf">function</span>(expr, filename, ...) {</span>
<span id="cb755-12"><a href="versioncontrol.html#cb755-12"></a>  </span>
<span id="cb755-13"><a href="versioncontrol.html#cb755-13"></a>  <span class="kw">pdf</span>(filename, ...)</span>
<span id="cb755-14"><a href="versioncontrol.html#cb755-14"></a>  <span class="kw">on.exit</span>(<span class="kw">dev.off</span>())</span>
<span id="cb755-15"><a href="versioncontrol.html#cb755-15"></a>  </span>
<span id="cb755-16"><a href="versioncontrol.html#cb755-16"></a>  <span class="co"># A trick to run the provided function call in the global environment</span></span>
<span id="cb755-17"><a href="versioncontrol.html#cb755-17"></a>  <span class="kw">eval.parent</span>(<span class="kw">substitute</span>(expr))</span>
<span id="cb755-18"><a href="versioncontrol.html#cb755-18"></a>}</span>
<span id="cb755-19"><a href="versioncontrol.html#cb755-19"></a></span>
<span id="cb755-20"><a href="versioncontrol.html#cb755-20"></a></span>
<span id="cb755-21"><a href="versioncontrol.html#cb755-21"></a><span class="co"># Finally, after having sourced both our function definition, </span></span>
<span id="cb755-22"><a href="versioncontrol.html#cb755-22"></a><span class="co"># and the generic function to.pdf, we can make the PDFs.</span></span>
<span id="cb755-23"><a href="versioncontrol.html#cb755-23"></a><span class="kw">to.pdf</span>(</span>
<span id="cb755-24"><a href="versioncontrol.html#cb755-24"></a>  <span class="kw">soilplot_1</span>(allTheta), </span>
<span id="cb755-25"><a href="versioncontrol.html#cb755-25"></a>  <span class="dt">filename =</span> <span class="st">&quot;output/figures/figure1.pdf&quot;</span></span>
<span id="cb755-26"><a href="versioncontrol.html#cb755-26"></a>)</span></code></pre></div>
</div>
<div id="facesoil_load" class="section level3">
<h3><span class="header-section-number">6.7.2</span> <code>facesoil_load</code></h3>
<p>This script contains all the bits of code that are</p>
<ul>
<li>Cleaning the workspace</li>
<li>Loading homemade functions</li>
<li>Reading and pre-processing the raw data</li>
</ul>
<p>It is useful to load all packages in one location in your, which makes it easy to fix problems should they arise (i.e., some packages are not installed, or not available).</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="versioncontrol.html#cb756-1"></a><span class="co"># Load packages</span></span>
<span id="cb756-2"><a href="versioncontrol.html#cb756-2"></a><span class="kw">source</span>(<span class="st">&quot;load_packages.R&quot;</span>)</span>
<span id="cb756-3"><a href="versioncontrol.html#cb756-3"></a></span>
<span id="cb756-4"><a href="versioncontrol.html#cb756-4"></a><span class="co"># Source functions (this loads functions but does no actual work)</span></span>
<span id="cb756-5"><a href="versioncontrol.html#cb756-5"></a><span class="kw">source</span>(<span class="st">&quot;Rfunctions/rmDup.R&quot;</span>)</span>
<span id="cb756-6"><a href="versioncontrol.html#cb756-6"></a></span>
<span id="cb756-7"><a href="versioncontrol.html#cb756-7"></a><span class="co"># Make the processed data (this runs a script)</span></span>
<span id="cb756-8"><a href="versioncontrol.html#cb756-8"></a><span class="kw">source</span>(<span class="st">&quot;facesoil_readdata.R&quot;</span>)</span></code></pre></div>
</div>
<div id="load_packages.r" class="section level3">
<h3><span class="header-section-number">6.7.3</span> <code>load_packages.R</code></h3>
<p>We find it very convenient to collect all <code>library</code> calls throughout your project in a single script. The advantage is that at the top of one of the main analysis scripts, we can simply call <code>source("load_packages.R")</code>. If any packages are missing, or something else failed, we know before try to we execute any other code.</p>
<p>It may also be convenient to suppress all messages we see when loading packages. An example script may look like:</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="versioncontrol.html#cb757-1"></a><span class="kw">suppressPackageStartupMessages</span>({</span>
<span id="cb757-2"><a href="versioncontrol.html#cb757-2"></a>  <span class="kw">library</span>(dplyr)</span>
<span id="cb757-3"><a href="versioncontrol.html#cb757-3"></a>  <span class="kw">library</span>(lubridate)</span>
<span id="cb757-4"><a href="versioncontrol.html#cb757-4"></a>  <span class="kw">library</span>(glue)</span>
<span id="cb757-5"><a href="versioncontrol.html#cb757-5"></a>})</span></code></pre></div>
<p>The <em>disadvantage</em> of a loading script like this is that we assume that the user has installed all of the required packages. In Rstudio, however, if you open this script - a small message will appear at the top of the script, “Would you like to install missing packages?”. If you click OK all packages mentioned in the script that you have not installed will be installed for you.</p>
<p>Another approach uses the <code>pacman</code> package, which automatically installs missing packages (see also Section <a href="intro.html#pacman">1.10.9</a>):</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="versioncontrol.html#cb758-1"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(pacman))<span class="kw">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: pacman</code></pre>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="versioncontrol.html#cb760-1"></a>pacman<span class="op">::</span><span class="kw">p_load</span>(gplots, geometry, rgl, remotes, svglite)</span></code></pre></div>

<div class="rmdreading">
To learn more about advanced management of R package dependencies, read Chapter <a href="masteringpackages.html#masteringpackages">7</a>
</div>


<div class="rmdcaution">
Never include <code>install.packages</code> in any of your <em>scripts</em> in your project. You do not want to call it more than once, otherwise the execution of the project will be much slower (and require an internet connection).
</div>

</div>
<div id="facesoil_readdata.r" class="section level3">
<h3><span class="header-section-number">6.7.4</span> <code>facesoil_readdata.R</code></h3>
<p>This script produces a dataframe based on the raw CSV files in the <code>rawdata</code> folder. The example below just reads a dataset and changes the DateTime variable to a POSIXct class. In this script, I normally also do all the tedious things like deleting missing data, converting dates and times, merging, adding new variables, and so on. The advantage of placing all of this in a separate script is that you keep the boring bits separate from the code that generates results, such as figures, tables, and analyses.</p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="versioncontrol.html#cb761-1"></a><span class="co"># Read raw data from &#39;rawdata&#39; subfolder</span></span>
<span id="cb761-2"><a href="versioncontrol.html#cb761-2"></a>allTheta &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;rawdata/FACE_SOIL_theta_2013.csv&quot;</span>)</span>
<span id="cb761-3"><a href="versioncontrol.html#cb761-3"></a></span>
<span id="cb761-4"><a href="versioncontrol.html#cb761-4"></a><span class="co"># Convert DateTime</span></span>
<span id="cb761-5"><a href="versioncontrol.html#cb761-5"></a>allTheta<span class="op">$</span>DateTime &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="kw">as.character</span>(allTheta<span class="op">$</span>DateTime))</span>
<span id="cb761-6"><a href="versioncontrol.html#cb761-6"></a></span>
<span id="cb761-7"><a href="versioncontrol.html#cb761-7"></a><span class="co"># Add Date</span></span>
<span id="cb761-8"><a href="versioncontrol.html#cb761-8"></a>allTheta<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(allTheta<span class="op">$</span>DateTime)</span>
<span id="cb761-9"><a href="versioncontrol.html#cb761-9"></a></span>
<span id="cb761-10"><a href="versioncontrol.html#cb761-10"></a><span class="co"># Etc.</span></span></code></pre></div>
</div>
</div>
<div id="archiving-the-output" class="section level2">
<h2><span class="header-section-number">6.8</span> Archiving the output</h2>
<p>In the example workflow we have set up in the previous sections, all items in the output folder will be automatically overwritten every time we run the master script <code>facesoil_analysis.R</code>. One simple way to back up your previous results is to create a zipfile of the entire output directory, place it in the <code>archive</code> folder, and rename it so it has the date as part of the filename.</p>
<p>After a while, that directory may look like this:</p>
<p><img src="screenshots/archive.png" width="70%" /></p>
<p><strong>Contents of archive folder, example.</strong></p>
<p>If your <code>processData</code> folder is very large, this may not be the optimal solution. Perhaps the <code>processedData</code> can be in a separate output folder, for example.</p>
<div id="adding-a-date-stamp-to-output-files" class="section level3">
<h3><span class="header-section-number">6.8.1</span> Adding a Date stamp to output files</h3>
<p>Another option is to use a slightly different output filename every time, most usefully with the current Date as part of the filename. The following example shows how you can achieve this with the <code>today</code> from the <code>lubridate</code> package, and the <code>glue</code> package:</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="versioncontrol.html#cb762-1"></a><span class="co"># For the following to work, load lubridate</span></span>
<span id="cb762-2"><a href="versioncontrol.html#cb762-2"></a><span class="co"># Recall that in your workflow, it is best to load all packages in one place.</span></span>
<span id="cb762-3"><a href="versioncontrol.html#cb762-3"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb762-4"><a href="versioncontrol.html#cb762-4"></a><span class="kw">library</span>(glue)</span>
<span id="cb762-5"><a href="versioncontrol.html#cb762-5"></a></span>
<span id="cb762-6"><a href="versioncontrol.html#cb762-6"></a><span class="co"># Make a filename with the current Date:</span></span>
<span id="cb762-7"><a href="versioncontrol.html#cb762-7"></a>fn &lt;-<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;output/figures/FACE_soilfigure1_{today()}.pdf&quot;</span>)</span>
<span id="cb762-8"><a href="versioncontrol.html#cb762-8"></a>fn</span></code></pre></div>
<pre><code>## output/figures/FACE_soilfigure1_2020-11-09.pdf</code></pre>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="versioncontrol.html#cb764-1"></a><span class="co"># Also add the current time, make sure to reformat as &#39;:&#39; is not allowed!</span></span>
<span id="cb764-2"><a href="versioncontrol.html#cb764-2"></a>fn &lt;-<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;output/figures/FACE_soilfigure1_{format(now(),&#39;%Y-%m-%d_%H-%M&#39;)}.pdf&quot;</span>)</span>
<span id="cb764-3"><a href="versioncontrol.html#cb764-3"></a>fn</span></code></pre></div>
<pre><code>## output/figures/FACE_soilfigure1_2020-11-09_21-27.pdf</code></pre>
</div>
</div>
<div id="scriptstructure" class="section level2">
<h2><span class="header-section-number">6.9</span> A logical structure for your scripts</h2>
<div id="write-functions-not-long-scripts" class="section level3">
<h3><span class="header-section-number">6.9.1</span> Write functions, not long scripts</h3>
<p>If a script becomes too long, write more functions. Writing your own functions is the most important advise if you want to write and maintain robust, complex projects.</p>
<p>As pointed out in the Chapter on Project management (<a href="#projectman"><strong>??</strong></a>), save these functions separately, for example “R/functions.R”, and <code>source</code> them with:</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="versioncontrol.html#cb766-1"></a><span class="kw">source</span>(<span class="st">&quot;R/functions.R&quot;</span>)</span></code></pre></div>
<p>Unfortunately <code>source</code> is not vectorized, so to read all R scripts from a subdirectory you can simply do,</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="versioncontrol.html#cb767-1"></a><span class="cf">for</span>(fn <span class="cf">in</span> <span class="kw">dir</span>(<span class="st">&quot;R&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;[.]R$&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)){</span>
<span id="cb767-2"><a href="versioncontrol.html#cb767-2"></a>  <span class="kw">source</span>(fn)</span>
<span id="cb767-3"><a href="versioncontrol.html#cb767-3"></a>}</span></code></pre></div>

<div class="rmdtry">
Write the above snippet into a function, which takes the directory to search as an argument.
</div>

</div>
<div id="divide-your-script-into-functional-blocks" class="section level3">
<h3><span class="header-section-number">6.9.2</span> Divide your script into functional blocks</h3>
<p>Dividing your scripts into a few functional blocks can help readability and reliability.
With special formatting, you can even improve the <em>table of contents</em> (TOC) menu in Rstudio for a script. Run the example below, and then find the TOC button in Rstudio:</p>
<p><img src="screenshots/tablecontents_button.png" width="30%" /></p>
<p><strong>Access the (nearly) automatic TOC in Rstudio</strong></p>
<p>In the following example script, note that we load all packages at the beginning of the script, so that when something goes wrong at that stage, we know before executing any of the ‘real’ code.</p>
<p>Also note the use of <code>#-----</code>, this helps to make the TOC as mentioned above.</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="versioncontrol.html#cb768-1"></a><span class="co"># An example script</span></span>
<span id="cb768-2"><a href="versioncontrol.html#cb768-2"></a><span class="co"># 2020, Author</span></span>
<span id="cb768-3"><a href="versioncontrol.html#cb768-3"></a></span>
<span id="cb768-4"><a href="versioncontrol.html#cb768-4"></a></span>
<span id="cb768-5"><a href="versioncontrol.html#cb768-5"></a><span class="co">#----- Load packages -----</span></span>
<span id="cb768-6"><a href="versioncontrol.html#cb768-6"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb768-7"><a href="versioncontrol.html#cb768-7"></a><span class="kw">library</span>(rvest)</span>
<span id="cb768-8"><a href="versioncontrol.html#cb768-8"></a><span class="kw">library</span>(stringr)</span>
<span id="cb768-9"><a href="versioncontrol.html#cb768-9"></a><span class="kw">library</span>(glue)</span>
<span id="cb768-10"><a href="versioncontrol.html#cb768-10"></a></span>
<span id="cb768-11"><a href="versioncontrol.html#cb768-11"></a><span class="co">#----- Custom functions -----</span></span>
<span id="cb768-12"><a href="versioncontrol.html#cb768-12"></a><span class="kw">source</span>(<span class="st">&quot;R/functions.R&quot;</span>)</span>
<span id="cb768-13"><a href="versioncontrol.html#cb768-13"></a><span class="kw">source</span>(<span class="st">&quot;R/database_functions.R&quot;</span>)</span>
<span id="cb768-14"><a href="versioncontrol.html#cb768-14"></a></span>
<span id="cb768-15"><a href="versioncontrol.html#cb768-15"></a><span class="co">#----- Configuration -----</span></span>
<span id="cb768-16"><a href="versioncontrol.html#cb768-16"></a></span>
<span id="cb768-17"><a href="versioncontrol.html#cb768-17"></a><span class="co"># Load configuration (passwords etc., see next Section!)</span></span>
<span id="cb768-18"><a href="versioncontrol.html#cb768-18"></a>.conf &lt;-<span class="st"> </span>yaml<span class="op">::</span><span class="kw">read_yaml</span>(<span class="dt">file =</span> <span class="st">&quot;config.yml&quot;</span>)</span>
<span id="cb768-19"><a href="versioncontrol.html#cb768-19"></a></span>
<span id="cb768-20"><a href="versioncontrol.html#cb768-20"></a><span class="co">#----- Database -----</span></span>
<span id="cb768-21"><a href="versioncontrol.html#cb768-21"></a></span>
<span id="cb768-22"><a href="versioncontrol.html#cb768-22"></a><span class="co"># Make database connection</span></span>
<span id="cb768-23"><a href="versioncontrol.html#cb768-23"></a>db_con &lt;-<span class="st"> </span><span class="kw">make_database_connection_knmi</span>(.conf)</span>
<span id="cb768-24"><a href="versioncontrol.html#cb768-24"></a></span>
<span id="cb768-25"><a href="versioncontrol.html#cb768-25"></a><span class="co"># Download data</span></span>
<span id="cb768-26"><a href="versioncontrol.html#cb768-26"></a>cloud_data &lt;-<span class="st"> </span><span class="kw">download_cloud_data</span>(<span class="dt">con =</span> db_con)</span>
<span id="cb768-27"><a href="versioncontrol.html#cb768-27"></a></span>
<span id="cb768-28"><a href="versioncontrol.html#cb768-28"></a><span class="co"># Archive the data</span></span>
<span id="cb768-29"><a href="versioncontrol.html#cb768-29"></a>fn &lt;-<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;archive/out_{Sys.Date()}.rds&quot;</span>)</span>
<span id="cb768-30"><a href="versioncontrol.html#cb768-30"></a><span class="kw">try</span>(<span class="kw">saveRDS</span>(cloud_data, fn), <span class="dt">silent =</span> <span class="ot">TRUE</span>)</span>
<span id="cb768-31"><a href="versioncontrol.html#cb768-31"></a></span>
<span id="cb768-32"><a href="versioncontrol.html#cb768-32"></a><span class="co">#----- Visualization -----</span></span>
<span id="cb768-33"><a href="versioncontrol.html#cb768-33"></a></span>
<span id="cb768-34"><a href="versioncontrol.html#cb768-34"></a><span class="co"># Make visuals</span></span>
<span id="cb768-35"><a href="versioncontrol.html#cb768-35"></a><span class="kw">make_cloud_maps</span>(<span class="dt">data =</span> cloud_data)</span>
<span id="cb768-36"><a href="versioncontrol.html#cb768-36"></a></span>
<span id="cb768-37"><a href="versioncontrol.html#cb768-37"></a><span class="co">#----- Model -----</span></span>
<span id="cb768-38"><a href="versioncontrol.html#cb768-38"></a></span>
<span id="cb768-39"><a href="versioncontrol.html#cb768-39"></a><span class="co"># Do some advanced modelling</span></span>
<span id="cb768-40"><a href="versioncontrol.html#cb768-40"></a>model_run &lt;-<span class="st"> </span><span class="kw">run_cloudy_model</span>(<span class="dt">data =</span> cloud_data)</span>
<span id="cb768-41"><a href="versioncontrol.html#cb768-41"></a></span>
<span id="cb768-42"><a href="versioncontrol.html#cb768-42"></a><span class="co"># Upload the model results to a remote database</span></span>
<span id="cb768-43"><a href="versioncontrol.html#cb768-43"></a><span class="kw">upload_model_db16</span>(model_run, <span class="dt">config =</span> .conf)</span></code></pre></div>
<p>The <em>fictional</em> script above is just an example how you can divide a <em>master script</em> into logical statements, using functions that perform all the underlying tasks.</p>
<p>One major advantage of the above approach is because functions execute their “inner workings” in a <strong>separate environment</strong>, which means that objects inside a function are not visible either outside the function (like the main script) or in any other script.</p>
<p>That way, executing the script above does not produce any objects in the environment (the memory) other than the ones <em>returned</em> by the functions. All the intermediate objects that were executed inside each function have disappeared, freeing memory and avoiding conflicts.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="webservices.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="masteringpackages.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "linkedin"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["prcr.pdf"],
"toc": {
"collapse": "subsection"
},
"favicon": "favicon.ico",
"githubrepo": "RemkoDuursma/prcr",
"description": "A Learning Guide to R: : data, analytical, and programming skills"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
